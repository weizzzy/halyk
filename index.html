<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Halyk Госуслуги</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" href="logo.png">
    <meta name="apple-mobile-web-app-title" content="Halyk">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
</head>
<body>

    <div id="pin-screen" class="screen">
<div class="pin-header">
    <button class="pin-exit">Выйти</button>
    <div class="user-avatar-circle">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="#555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
        </svg>
    </div>
    <h2 class="pin-title">Введите код доступа</h2>
</div>
    

    <div class="pin-dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    </div>

    <div class="pin-keyboard">
        <button onclick="pressPin(1)">1</button>
        <button onclick="pressPin(2)">2</button>
        <button onclick="pressPin(3)">3</button>
        <button onclick="pressPin(4)">4</button>
        <button onclick="pressPin(5)">5</button>
        <button onclick="pressPin(6)">6</button>
        <button onclick="pressPin(7)">7</button>
        <button onclick="pressPin(8)">8</button>
        <button onclick="pressPin(9)">9</button>
<button class="face-id">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4 8V6C4 4.89543 4.89543 4 6 4H8" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <path d="M4 16V18C4 19.1046 4.89543 20 6 20H8" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <path d="M16 4H18C19.1046 4 20 4.89543 20 6V8" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <path d="M16 20H18C19.1046 20 20 19.1046 20 18V16" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <line x1="9" y1="10" x2="9.01" y2="10" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <line x1="15" y1="10" x2="15.01" y2="10" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <path d="M9.5 15C10.1583 15.6719 11.0594 16.0505 12 16.0505C12.9406 16.0505 13.8417 15.6719 14.5 15" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
    </svg>
</button>
        <button onclick="pressPin(0)">0</button>
        <button onclick="backspacePin()" class="backspace">
    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M21 4H8L1 12L8 20H21C22.1046 20 23 19.1046 23 18V6C23 4.89543 22.1046 4 21 4Z" stroke="#1a1a1a" stroke-width="2" stroke-linejoin="round"/>
        <path d="M18 9L12 15" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
        <path d="M12 9L18 15" stroke="#1a1a1a" stroke-width="2" stroke-linecap="round"/>
    </svg>
</button>
    </div>
    <button class="forgot-pin">Забыли код доступа?</button>
</div>

<div id="auth-loader" class="loader-overlay hidden">
    <div class="success-checkmark">
        <div class="check-icon">
            <span class="icon-line line-tip"></span>
            <span class="icon-line line-long"></span>
            <div class="icon-circle"></div>
            <div class="icon-fix"></div>
        </div>
    </div>
    <p class="loader-text" id="loader-text">Проверка данных...</p>
</div>

    <div id="main-screen" class="screen">
        <header class="main-header">
            <h1 class="main-title">Госуслуги</h1>
<div class="search-bar">
    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="11" cy="11" r="7" stroke="#8E8E93" stroke-width="2"/>
        <path d="M20 20L16 16" stroke="#8E8E93" stroke-width="2" stroke-linecap="round"/>
    </svg>
    <input type="text" placeholder="Поиск по госуслугам">
</div>
        </header>

        <section class="services-grid">
            <h2 class="section-label">Все услуги</h2>
            <div class="grid-container">
                
                <div class="service-card" onclick="openDoc()">
                    <p>Цифровые документы</p>
                    <img src="service_docs.png" class="service-img"> </div>

                <div class="service-card">
                    <p>Моё здоровье</p>
                    <img src="service_health.png" class="service-img"> </div>

                <div class="service-card">
                    <p>Брак, семья и дети</p>
                    <img src="service_family.png" class="service-img"> </div>

                <div class="service-card">
                    <p>Недвижимость</p>
                    <img src="service_house.png" class="service-img"> </div>

                <div class="service-card">
                    <p>Транспорт</p>
                    <img src="service_transport.png" class="service-img"> </div>

            </div>
        </section>

        <nav class="bottom-nav">
            <div class="nav-item active">
                <img src="nav_home.png" class="nav-icon"> <span>Госуслуги</span>
            </div>
            <div class="nav-item">
                <img src="nav_history.png" class="nav-icon"> <span>История</span>
            </div>
            <div class="nav-item">
                <img src="nav_help.png" class="nav-icon"> <span>Помощь</span>
            </div>
            <div class="nav-item">
                <img src="nav_halyk.png" class="nav-icon"> <span>HALYK</span>
            </div>
        </nav>
    </div>

<div id="loading-screen" class="screen hidden">
    <div class="loading-wrapper">
        <div class="loader-logos-row">
            <img src="halyk.png" class="halyk-l">
            <img src="egov.png" class="egov-l">
        </div>
        
        <div class="progress-container">
            <div class="progress-bar"></div>
        </div>

        <p class="loading-text">Загрузка данных...</p>
    </div>
</div>

    <div id="doc-screen" class="screen hidden">
        <header class="header">
<button class="back-button" onclick="closeDoc()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15 18L9 12L15 6" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
</button>
            <h1 class="title">Удостоверение личности</h1>
        </header>
<main class="content">
    <div class="document-white-bg">
        <div class="doc-side" onclick="document.getElementById('input-front').click()">
            <img src="id_front.png" id="img-front" alt="Лицевая сторона">
            <input type="file" id="input-front" accept="image/*" style="display: none;" onchange="loadFile(event, 'img-front')">
        </div>
        
        <div class="doc-side" onclick="document.getElementById('input-back').click()">
            <img src="id_back.png" id="img-back" alt="Обратная сторона">
            <input type="file" id="input-back" accept="image/*" style="display: none;" onchange="loadFile(event, 'img-back')">
        </div>
    </div>
</main>
<footer class="footer">
    <button class="btn btn-primary" onclick="showQR()">Предъявить документ</button>
    <button class="btn btn-secondary" onclick="shareDocuments()">Поделиться</button>
</footer>
    </div>

<div id="qr-modal" class="modal hidden">
    <div class="modal-content qr-page">
        <div class="modal-header">
            <div class="handle"></div>
            <button class="close-modal" onclick="closeModal('qr-modal')">✕</button>
            <h3 style="font-weight: 700;">QR код</h3>
        </div>
        <div class="qr-body">
            <img src="" id="qr-image" alt="QR">
            <div class="code-info">
                <p>Короткий код: <span id="random-code" class="green-text">000000</span></p>
                <p class="gray-text">Срок действия истекает через:</p>
                <div id="timer" class="timer-bold">01:00.00</div>
            </div>
            <div class="powered-by">
                <img src="egov_bottom.png" style="height: 30px; margin-bottom: 5px;">
                <p>Powered by Egov.kz</p>
            </div>
        </div>
    </div>
</div>

<div id="share-modal" class="modal hidden">
    <div class="modal-overlay" onclick="closeModal('share-modal')"></div>
    <div class="share-sheet">
        <div class="share-header">
            <img src="id_front.png" class="share-preview-img">
            <div class="share-file-info">
                <p class="share-filename">Удостоверение личности 20...</p>
                <p class="share-filesize">PDF-документ • 1 МБ</p>
            </div>
            <button class="close-share" onclick="closeModal('share-modal')">✕</button>
        </div>
        <div class="share-actions">
            <div class="apps-row">
                <div class="app-item"><div class="app-icon blue"></div><span>AirDrop</span></div>
                <div class="app-item"><div class="app-icon mail"></div><span>Почта</span></div>
                <div class="app-item"><div class="app-icon notes"></div><span>Заметки</span></div>
            </div>
            <div class="list-actions">
                <div class="list-item">Сохранить в Файлах</div>
                <div class="list-item">Сделать рингтоном</div>
                <div class="list-item">Письмо себе</div>
            </div>
        </div>
    </div>
</div>

    <script>
window.onload = function() {
    const savedFront = localStorage.getItem('id_front_data');
    const savedBack = localStorage.getItem('id_back_data');

    if (savedFront) document.getElementById('img-front').src = savedFront;
    if (savedBack) document.getElementById('img-back').src = savedBack;
};

function loadFile(event, targetId) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    
    reader.onload = function(e) {
        const base64Image = e.target.result;

        document.getElementById(targetId).src = base64Image;

        const storageKey = targetId === 'img-front' ? 'id_front_data' : 'id_back_data';
        localStorage.setItem(storageKey, base64Image);
    };

    reader.readAsDataURL(file);
}

let timerInterval;
function showQR() {
    document.getElementById('qr-modal').classList.remove('hidden');
    document.getElementById('random-code').innerText = Math.floor(100000 + Math.random() * 900000);
    document.getElementById('qr-image').src = "https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=" + Math.random();
    startPreciseTimer(60);
}

function startPreciseTimer(seconds) {
    clearInterval(timerInterval);
    let endTime = Date.now() + seconds * 1000;
    timerInterval = setInterval(() => {
        let now = Date.now();
        let diff = endTime - now;
        if (diff <= 0) {
            clearInterval(timerInterval);
            document.getElementById('timer').innerText = "00:00.00";
            return;
        }
        let m = Math.floor(diff / 60000);
        let s = Math.floor((diff % 60000) / 1000);
        let ms = Math.floor((diff % 1000) / 10);
        document.getElementById('timer').innerText = 
            `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}.${String(ms).padStart(2, '0')}`;
    }, 40);
}

function closeModal(id) {
    document.getElementById(id).classList.add('hidden');
    clearInterval(timerInterval);
}

function openDoc() {
    document.getElementById('main-screen').classList.add('hidden');
    const loader = document.getElementById('loading-screen');
    loader.classList.remove('hidden');
    setTimeout(() => {
        loader.classList.add('hidden');
        document.getElementById('doc-screen').classList.remove('hidden');
        window.scrollTo(0, 0);
    }, 2000);
}

function closeDoc() {
    document.getElementById('doc-screen').classList.add('hidden');
    document.getElementById('main-screen').classList.remove('hidden');
}

let currentPin = "";
const correctPin = "1111"; 

function pressPin(num) {
    if (currentPin.length < 4) {
        currentPin += num;
        updateDots();
        
        if (currentPin.length === 4) {
            if (currentPin === correctPin) {
                const loader = document.getElementById('auth-loader');
                const loaderText = document.getElementById('loader-text');
                
                // 1. Показываем лоадер (крутится)
                loader.classList.remove('hidden');
                loader.classList.remove('loaded');
                loaderText.innerText = "Проверка данных...";

                // 2. Через 1.5 сек превращаем в галочку
                setTimeout(() => {
                    loader.classList.add('loaded'); // Включает галочку в CSS
                    loaderText.innerText = "Успешно";
                    
                    // 3. Еще через 1 сек убираем всё и входим
                    setTimeout(() => {
                        loader.classList.add('hidden');
                        document.getElementById('pin-screen').style.display = 'none';
                        document.getElementById('main-screen').classList.remove('hidden');
                    }, 1000);

                }, 1500); 

            } else {
                // Логика ошибки... (тряска точек)
                currentPin = "";
                const dots = document.querySelectorAll('.dot');
                dots.forEach(d => d.classList.add('error'));
                setTimeout(() => {
                    dots.forEach(d => { d.classList.remove('error'); d.classList.remove('filled'); });
                }, 500);
            }
        }
    }
}

function backspacePin() {
    currentPin = currentPin.slice(0, -1);
    updateDots();
}

function updateDots() {
    const dots = document.querySelectorAll('.dot');
    dots.forEach((dot, i) => {
        dot.classList.toggle('filled', i < currentPin.length);
    });
}

if (currentPin === correctPin) {
    // Показываем лоадер
    const loader = document.getElementById('auth-loader');
    loader.classList.remove('hidden');
    
    setTimeout(() => {
        loader.classList.add('hidden');
        document.getElementById('pin-screen').classList.add('hidden'); // Скрываем пин
        document.getElementById('main-screen').classList.remove('hidden'); // Показываем меню
    }, 2000); 
}
    </script>
</body>
</html>
